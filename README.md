# forensics
Various tools that can be useful in forensics



**Коменты для HonyScan.py**  
Давайте подробно разберем, что делает этот скрипт и какой результат его работы ожидается при различных условиях:

1. **Слушает входящий трафик**:
   Скрипт использует `sniff` из модуля Scapy для отслеживания входящего TCP трафика на определенный IP-адрес (`ip_address`).

2. **Анализирует каждый TCP пакет с помощью функции `analyze_packets`**:
   Функция `analyze_packets` вызывается для каждого захваченного пакета. Она проверяет, содержит ли пакет TCP слой и является ли TCP флаг начального запроса SYN (`"S"`).

3. **Логика работы с заблокированными хостами**:
   А. Если исходящий пакет приходит от хоста из списка заблокированных (`blocked_hosts`):
      - На **открытый порт** (`open_ports`): Отправляет обратно пакет с флагами RST и ACK, что означает принудительное закрытие соединения для данного хоста.
      - На **"медовый" порт** (`honey_ports`): Отправляет обратно пакет с флагами SYN и ACK, имитируя открытое соединение, чтобы привлечь внимание сканеров.

   Б. Если пакет приходит от хоста, не входящего в список заблокированных:
      - На порт, который не входит в список `open_ports` и `honey_ports`: Добавляет IP-адрес хоста в список заблокированных (`blocked_hosts`), но никакого пакета не отправляет.
      - На **"медовый" порт** (`honey_ports`): Отправляет обратно пакет с флагами SYN и ACK, также имитируя открытое соединение.

4. **Отправка ответных пакетов**:
   Функция `create_response` создает пакет ответа с соответствующими флагами, которые были определены в `analyze_packets`. Этот пакет отправляется обратно исходящему хосту с помощью функции `sendp`.

Итак, ожидаемые результаты работы скрипта при различных условиях:

- Если запрос идет от заблокированного хоста на порт из списка `open_ports`, скрипт отправит пакет с флагами RST и ACK, что означает отклонение соединения.

- Если запрос исходит от заблокированного хоста на порт из списка `honey_ports`, скрипт отправит пакет с флагами SYN и ACK, имитируя открытое соединение.

- Если запрос исходит не от заблокированного хоста:
  - На порт, не входящий в список `open_ports` или `honey_ports`, IP-адрес хоста будет добавлен в список заблокированных, но ответ не отправляется.
  - На порт из списка `honey_ports`, скрипт отправит пакет с флагами SYN и ACK.

Таким образом, скрипт предназначен для мониторинга и реагирования на входящий трафик с целью отклонения соединений от заблокированных хостов на определенные порты и привлечения внимания потенциальных сканеров к "медовым" портам.


-Когда заблокированный хост пытается подключиться к порту из списка open_ports, скрипт отправляет пакет с флагами RST+ACK (Reset + Acknowledgment), что означает закрытие соединения и является стандартным способом отказа в установлении TCP соединения.  
-Когда заблокированный хост пытается подключиться к порту из списка honey_ports, скрипт отправляет пакет с флагами SYN+ACK (Synchronize + Acknowledgment), что имитирует успешное установление соединения. Это делается для отслеживания потенциально злонамеренной активности, так как "медовые" порты обычно не используются для реальных сервисов и предназначены для приманки сканеров и злоумышленников.